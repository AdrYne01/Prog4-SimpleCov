<!DOCTYPE html>
<!-- saved from url=(0167)http://localhost:63342/reimplementation-back-end/coverage/index.html?_ijt=mus2sclaj1i1k5gnjvv79pld20&_ij_reload=RELOAD_ON_SAVE#e988dc2fe513ced4a722235297b6474bbf350e0c -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Code coverage for Reimplementation-back-end</title>
    
    <script src="./application.js.download" type="text/javascript"></script>
    <link href="./application.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    
    <link rel="icon" type="image/png" href="http://localhost:63342/reimplementation-back-end/coverage/assets/0.12.3/favicon.png">
  <link rel="shortcut icon" type="image/png" href="http://localhost:63342/reimplementation-back-end/coverage/assets/0.12.3/favicon_yellow.png"></head>

  <body data-new-gr-c-s-check-loaded="14.1168.0" data-gr-ext-installed="">
    <div id="loading" style="display: none;">
      <img src="./loading.gif" alt="loading">
    </div>
    <div id="wrapper" class="hide" style="display: block;">
      <div class="timestamp">Generated <abbr class="timeago" title="2024-04-23T21:44:36-04:00">14 minutes ago</abbr></div>
      <ul class="group_tabs"><li class="active"><a href="http://localhost:63342/reimplementation-back-end/coverage/index.html?_ijt=mus2sclaj1i1k5gnjvv79pld20&amp;_ij_reload=RELOAD_ON_SAVE#AllFiles" class="AllFiles">All Files (
      <span class="yellow">
  86.84%
</span>

     )</a></li></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles" style="display: none;">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent">
      <span class="yellow">
  86.84%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         4.08
       </span>
    </span> hits/line
    )
  </h2>

  <a name="AllFiles"></a>

  <div>
    <b>2</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>38</b> relevant lines,
    <span class="green"><b>33</b> lines covered</span> and
    <span class="red"><b>5</b> lines missed. </span>
    (<span class="yellow">
  86.84%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper no-footer"><div id="DataTables_Table_0_filter" class="dataTables_filter"><label>Search:<input type="search" class="" placeholder="" aria-controls="DataTables_Table_0"></label></div><table class="file_list dataTable no-footer" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info">
      <thead>
        <tr role="row"><th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="File: activate to sort column ascending" style="width: 0px;">File</th><th class="cell--number sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-sort="ascending" aria-label="% covered: activate to sort column descending" style="width: 0px;">% covered</th><th class="cell--number sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Lines: activate to sort column ascending" style="width: 0px;">Lines</th><th class="cell--number sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Relevant Lines: activate to sort column ascending" style="width: 0px;">Relevant Lines</th><th class="cell--number sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Lines covered: activate to sort column ascending" style="width: 0px;">Lines covered</th><th class="cell--number sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Lines missed: activate to sort column ascending" style="width: 0px;">Lines missed</th><th class="cell--number sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Avg. Hits / Line: activate to sort column ascending" style="width: 0px;">Avg. Hits / Line</th></tr>
      </thead>
      <tbody>
        
          
        
          
        
      <tr class="t-file odd" role="row">
            <td class="strong t-file__name"><a href="http://localhost:63342/reimplementation-back-end/coverage/index.html?_ijt=mus2sclaj1i1k5gnjvv79pld20&amp;_ij_reload=RELOAD_ON_SAVE#fbbdfd840c8c48db51dafd9381b0971ae550fa81" class="src_link cboxElement" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
            <td class="red strong cell--number t-file__coverage sorting_1">57.14 %</td>
            <td class="cell--number">14</td>
            <td class="cell--number">7</td>
            <td class="cell--number">4</td>
            <td class="cell--number">3</td>
            <td class="cell--number">0.57</td>
            
          </tr><tr class="t-file even" role="row">
            <td class="strong t-file__name"><a href="http://localhost:63342/reimplementation-back-end/coverage/index.html?_ijt=mus2sclaj1i1k5gnjvv79pld20&amp;_ij_reload=RELOAD_ON_SAVE#e988dc2fe513ced4a722235297b6474bbf350e0c" class="src_link cboxElement" title="app/controllers/advice_controller.rb">app/controllers/advice_controller.rb</a></td>
            <td class="green strong cell--number t-file__coverage sorting_1">93.55 %</td>
            <td class="cell--number">105</td>
            <td class="cell--number">31</td>
            <td class="cell--number">29</td>
            <td class="cell--number">2</td>
            <td class="cell--number">4.87</td>
            
          </tr></tbody>
    </table><div class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">Showing 1 to 2 of 2 entries</div></div>
  </div>
</div>


        
      </div>

      <div id="footer">
        Generated by <a href="https://github.com/simplecov-ruby/simplecov">simplecov</a> v0.22.0
        and simplecov-html v0.12.3<br>
        using RSpec
      </div>

      <div class="source_files" style="display: none;">
      
        <div style="display: none;"></div>

      
        <div class="source_table" id="fbbdfd840c8c48db51dafd9381b0971ae550fa81">
  <div class="header">
    <h3>app/controllers/application_controller.rb</h3>
    <h4>
      <span class="red">
  57.14%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ApplicationController &lt; ActionController::Base</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby">  #include JwtToken</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def current_user</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">    @current_user ||= session[:user]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def current_role_name</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">    current_role.try :name</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def current_role</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">    current_user.try :role</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  

<script>
(function() {
  var ws = new WebSocket('ws://' + window.location.host + 
             '/jb-server-page?reloadMode=RELOAD_ON_SAVE&'+
             'referrer=' + encodeURIComponent(window.location.pathname));
  ws.onmessage = function (msg) {
      if (msg.data === 'reload') {
          window.location.reload();
      }
      if (msg.data.startsWith('update-css ')) {
          var messageId = msg.data.substring(11);
          var links = document.getElementsByTagName('link');
          for (var i = 0; i < links.length; i++) {
              var link = links[i];
              if (link.rel !== 'stylesheet') continue;
              var clonedLink = link.cloneNode(true);
              var newHref = link.href.replace(/(&|\?)jbUpdateLinksId=\d+/, "$1jbUpdateLinksId=" + messageId);
              if (newHref !== link.href) {
                clonedLink.href = newHref;
              }
              else {
                var indexOfQuest = newHref.indexOf('?');
                if (indexOfQuest >= 0) {
                  // to support ?foo#hash 
                  clonedLink.href = newHref.substring(0, indexOfQuest + 1) + 'jbUpdateLinksId=' + messageId + '&' + 
                                    newHref.substring(indexOfQuest + 1);
                }
                else {
                  clonedLink.href += '?' + 'jbUpdateLinksId=' + messageId;
                }
              }
              link.replaceWith(clonedLink);
          }
      }
  };
})();
</script><div id="cboxOverlay" style="opacity: 1; cursor: pointer; visibility: visible;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: block; visibility: visible; top: 18px; left: 39px; position: absolute; width: 1459px; height: 694px;"><div id="cboxWrapper" style="height: 694px; width: 1459px;"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left; width: 1431px;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left; height: 637px;"></div><div id="cboxContent" style="float: left; width: 1431px; height: 637px;"><div id="cboxLoadedContent" style="width: 1431px; overflow: auto; height: 632px;"><div class="source_table highlighted" id="e988dc2fe513ced4a722235297b6474bbf350e0c">
  <div class="header">
    <h3>app/controllers/advice_controller.rb</h3>
    <h4>
      <span class="green">
  93.55%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>31</b> relevant lines.
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]"><span class="class"><span class="keyword">class</span> <span class="title">AdviceController</span> <span class="inheritance">&lt; <span class="parent">ApplicationController</span></span></span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier">before_action</span> <span class="symbol">:<span class="identifier">set_questionnaire</span></span>, <span class="identifier">only</span><span class="symbol">:</span> %<span class="identifier">i</span>[ <span class="identifier">edit_advice</span> <span class="identifier">save_advice</span> ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Advice_controller first checks whether current user has TA privileges or not by implementing action_allowed? method. Secondly it sets the number of advices based on score and sort it in descending order. Then it checks four conditions for the advices.</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># 1. If number of advices is not equal to given advices</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># 2. If the sorted advices is empty</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># 3. If first advice score of sorted advices is NOT equal to max score</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># 4. If last advice score of sorted advices is NOT equal to min score</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># If any of the above condition are True, the edit_advice method calls adjust_advice_size of the QuestionnaireHelper class which adjust the advice sizes accordingly.</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># In the end, save_advice method is called which updates and saves the changes in the advices and displays the success/failure message.</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keymethods">include</span></span> <span class="constant">AuthorizationHelper</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># If current user is TA then only current user can edit and update the advice</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">action_allowed?</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="14">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier">current_user_has_ta_privileges?</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment">## This method will return true if the advice and its scores is invalid.</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Validates by utilizing the private methods invalid_advice_length? and invalid_advice_scores?</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">invalid_advice?</span><span class="params">(<span class="identifier">sorted_advice</span>, <span class="identifier">num_advices</span>, <span class="identifier">question</span>)</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="20">
            <span class="hits">12</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier">invalid_advice_length?</span>(<span class="identifier">num_advices</span>, <span class="identifier">question</span>, <span class="identifier">sorted_advice</span>) ||</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier">invalid_advice_scores?</span>(<span class="identifier">sorted_advice</span>)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Modify the advice associated with a questionnaire</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Separate methods were introduced to calculate the number of advices and sort the advices related to the current question attribute</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># This is done to adhere to Single Responsibility Principle</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">edit_advice</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="comment"># For each question in a questionnaire, this method adjusts the advice size if the advice size is &lt;,&gt; number of advices or</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="comment"># the max or min score of the advices does not correspond to the max or min score of questionnaire respectively.</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="30">
            <span class="hits">12</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="variable">@questionnaire</span>.<span class="identifier">questions</span>.<span class="identifier"><span class="keymethods">each</span></span> <span class="identifier"><span class="keyword">do</span></span> |<span class="identifier">question</span>|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="comment"># if the question is a scored question, store the number of advices corresponding to that question (max_score - min_score), else 0</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="33">
            <span class="hits">12</span>
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier">num_advices</span> = <span class="identifier">calculate_num_advices</span>(<span class="identifier">question</span>)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="comment"># sorting question advices in descending order by score</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="37">
            <span class="hits">12</span>
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier">sorted_advice</span> = <span class="identifier">sort_question_advices</span>(<span class="identifier">question</span>)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="comment"># Checks the condition for adjusting the advice size</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="40">
            <span class="hits">12</span>
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier"><span class="keyword">if</span></span> <span class="identifier">invalid_advice?</span>(<span class="identifier">sorted_advice</span>, <span class="identifier">num_advices</span>, <span class="identifier">question</span>)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby" data-result="[object Object]">        <span class="comment"># The number of advices for this question has changed.</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="42">
            <span class="hits">6</span>
            

            

            <code class="ruby" data-result="[object Object]">        <span class="constant">QuestionnaireHelper</span>.<span class="identifier">adjust_advice_size</span>(<span class="variable">@questionnaire</span>, <span class="identifier">question</span>)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># save the advice for a questionnaire</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">save_advice</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier"><span class="keyword">begin</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="comment"># checks if advice is present or not</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="53">
            <span class="hits">4</span>
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier"><span class="keyword">unless</span></span> <span class="identifier">params</span>[<span class="symbol">:<span class="identifier">advice</span></span>].<span class="identifier"><span class="keymethods">nil?</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="54">
            <span class="hits">3</span>
            

            

            <code class="ruby" data-result="[object Object]">        <span class="identifier">params</span>[<span class="symbol">:<span class="identifier">advice</span></span>].<span class="identifier"><span class="keymethods">each</span></span> <span class="identifier"><span class="keyword">do</span></span> |<span class="identifier">advice_key</span>, <span class="identifier">advice_params</span>|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby" data-result="[object Object]">          <span class="comment"># get existing advice to update by key with the passed in advice param</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="56">
            <span class="hits">6</span>
            

            

            <code class="ruby" data-result="[object Object]">          <span class="constant">QuestionAdvice</span>.<span class="identifier"><span class="keymethods">update</span></span>(<span class="identifier">advice_key</span>, <span class="identifier">advice</span><span class="symbol">:</span> <span class="identifier">advice_params</span>.<span class="identifier"><span class="keymethods">slice</span></span>(<span class="symbol">:<span class="identifier">advice</span></span>)[<span class="symbol">:<span class="identifier">advice</span></span>])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby" data-result="[object Object]">        <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby" data-result="[object Object]">        <span class="comment"># we made it here so it was saved</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="59">
            <span class="hits">3</span>
            

            

            <code class="ruby" data-result="[object Object]">        <span class="identifier">flash</span>[<span class="symbol">:<span class="identifier">notice</span></span>] = <span class="string">'The advice was successfully saved!'</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier"><span class="keyword">rescue</span></span> <span class="constant">ActiveRecord::RecordNotFound</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="comment"># If record not found, redirects to edit_advice and sends flash</span></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="63">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier">flash</span>[<span class="symbol">:<span class="identifier">notice</span></span>] = <span class="string">'The advice record was not found and saved!'</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="comment"># regardless of action above redirect to edit and show flash message if one exists</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="66">
            <span class="hits">4</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier">redirect_to</span> <span class="identifier">action</span><span class="symbol">:</span> <span class="string">'edit_advice'</span>, <span class="identifier"><span class="keymethods">id</span></span><span class="symbol">:</span> <span class="identifier">params</span>[<span class="symbol">:<span class="identifier"><span class="keymethods">id</span></span></span>]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier">private</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Common code for set questionnaire</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">set_questionnaire</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="comment"># Stores the questionnaire with given id in URL</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="74">
            <span class="hits">16</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="variable">@questionnaire</span> = <span class="constant">Questionnaire</span>.<span class="identifier"><span class="keymethods">find</span></span>(<span class="identifier">params</span>[<span class="symbol">:<span class="identifier"><span class="keymethods">id</span></span></span>])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment">## Checks to see if the advice is the correct length.</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment">#  Checks to see if the number of advices is different than the question_advices or advice is empty</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="79">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">invalid_advice_length?</span><span class="params">(<span class="identifier">num_advices</span>, <span class="identifier">question</span>, <span class="identifier">sorted_advice</span>)</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="80">
            <span class="hits">12</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier">question</span>.<span class="identifier">question_advices</span>.<span class="identifier"><span class="keymethods">length</span></span> != <span class="identifier">num_advices</span> ||</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier">sorted_advice</span>.<span class="identifier"><span class="keymethods">empty?</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment">## Checks to see if the scores are valid</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Checks to see if the first and last index of the sorted_advice array are different than expected.</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="86">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">invalid_advice_scores?</span><span class="params">(<span class="identifier">sorted_advice</span>)</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="87">
            <span class="hits">6</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier">sorted_advice</span>[<span class="number">0</span>].<span class="identifier">score</span> != <span class="variable">@questionnaire</span>.<span class="identifier">max_question_score</span> ||</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby" data-result="[object Object]">      <span class="identifier">sorted_advice</span>[<span class="identifier">sorted_advice</span>.<span class="identifier"><span class="keymethods">length</span></span> - <span class="number">1</span>].<span class="identifier">score</span> != <span class="variable">@questionnaire</span>.<span class="identifier">min_question_score</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Function to calculate number of advices for the current question attribute based on max and min question score.</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Method name is consistent with the functionality</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Refactored the 'if' statement into a ternary operator. This accomplishes the same logic in a more concise manner.</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="94">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">calculate_num_advices</span><span class="params">(<span class="identifier">question</span>)</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="95">
            <span class="hits">8</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier">question</span>.<span class="identifier"><span class="keymethods">is_a?</span></span>(<span class="constant">ScoredQuestion</span>) ? <span class="variable">@questionnaire</span>.<span class="identifier">max_question_score</span> - <span class="variable">@questionnaire</span>.<span class="identifier">min_question_score</span> + <span class="number">1</span> <span class="symbol">:</span> <span class="number">0</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># Function to sort question advices related to the current question attribute</span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="comment"># While sorting questions, sort_by(&amp;:score) is used instead of using a block. It is a shorthand notation and avoids creating a new Proc object for every element in the collection of the questions.</span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="101">
            <span class="hits">1</span>
            

            

            <code class="ruby" data-result="[object Object]">  <span class="function"><span class="keyword">def</span> <span class="title">sort_question_advices</span><span class="params">(<span class="identifier">question</span>)</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="102">
            <span class="hits">10</span>
            

            

            <code class="ruby" data-result="[object Object]">    <span class="identifier">question</span>.<span class="identifier">question_advices</span>.<span class="identifier"><span class="keymethods">sort_by</span></span>(&amp;<span class="symbol">:<span class="identifier">score</span></span>).<span class="identifier"><span class="keymethods">reverse</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="103">
            
            

            

            <code class="ruby" data-result="[object Object]">  <span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby" data-result="[object Object]"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby" data-result="[object Object]"><span class="identifier"><span class="keyword">end</span></span></code>
          </li>
        </div>
      
    </ol>
  </pre>
</div></div><div id="cboxTitle" style="float: left;">app/controllers/advice_controller.rb</div><div id="cboxCurrent" style="float: left; display: none;"></div><button type="button" id="cboxPrevious" style="display: none;"></button><button type="button" id="cboxNext" style="display: none;"></button><button type="button" id="cboxSlideshow" style="display: none;"></button><div id="cboxLoadingOverlay" style="float: left; display: none;"></div><div id="cboxLoadingGraphic" style="float: left; display: none;"></div><button type="button" id="cboxClose">close</button></div><div id="cboxMiddleRight" style="float: left; height: 637px;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left; width: 1431px;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; max-width: none; display: none;"></div></div></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>
